{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raw.githubusercontent.com/trevor-scheer/graphql-analyzer/main/crates/config/schema/graphqlrc.schema.json",
  "title": "GraphQL Configuration",
  "description": "Configuration file for GraphQL LSP and related tools",
  "oneOf": [
    {
      "description": "Single project configuration",
      "$ref": "#/definitions/ProjectConfig"
    },
    {
      "description": "Multi-project configuration",
      "type": "object",
      "required": ["projects"],
      "properties": {
        "projects": {
          "type": "object",
          "description": "Named projects in this configuration",
          "additionalProperties": {
            "$ref": "#/definitions/ProjectConfig"
          }
        }
      }
    }
  ],
  "definitions": {
    "ProjectConfig": {
      "type": "object",
      "required": ["schema"],
      "properties": {
        "schema": {
          "$ref": "#/definitions/SchemaConfig",
          "description": "GraphQL schema source(s)"
        },
        "documents": {
          "$ref": "#/definitions/DocumentsConfig",
          "description": "Document patterns for queries, mutations, and fragments"
        },
        "include": {
          "description": "File patterns to include",
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ]
        },
        "exclude": {
          "description": "File patterns to exclude",
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ]
        },
        "extensions": {
          "type": "object",
          "description": "Tool-specific extensions",
          "properties": {
            "lint": {
              "$ref": "#/definitions/LintConfig",
              "description": "Linting configuration for GraphQL documents"
            },
            "extractConfig": {
              "$ref": "#/definitions/ExtractConfig",
              "description": "Configuration for extracting GraphQL from TypeScript/JavaScript files"
            }
          },
          "additionalProperties": true
        }
      }
    },
    "SchemaConfig": {
      "description": "GraphQL schema source configuration",
      "oneOf": [
        {
          "type": "string",
          "description": "Single schema file path, glob pattern, or HTTP URL"
        },
        {
          "type": "array",
          "description": "Multiple schema sources",
          "items": {
            "type": "string",
            "description": "Schema file path, glob pattern, or HTTP URL"
          }
        },
        {
          "$ref": "#/definitions/IntrospectionSchemaConfig",
          "description": "Introspection configuration for remote schemas"
        }
      ]
    },
    "IntrospectionSchemaConfig": {
      "type": "object",
      "description": "Configuration for introspecting a remote GraphQL endpoint",
      "required": ["url"],
      "properties": {
        "url": {
          "type": "string",
          "description": "The GraphQL endpoint URL to introspect"
        },
        "headers": {
          "type": "object",
          "description": "HTTP headers to include in the introspection request (e.g., for authentication)",
          "additionalProperties": {
            "type": "string"
          }
        },
        "timeout": {
          "type": "integer",
          "description": "Request timeout in seconds (default: 30)",
          "minimum": 1
        },
        "retry": {
          "type": "integer",
          "description": "Number of retry attempts on failure (default: 0)",
          "minimum": 0
        }
      }
    },
    "DocumentsConfig": {
      "description": "Document source configuration",
      "oneOf": [
        {
          "type": "string",
          "description": "Single document pattern"
        },
        {
          "type": "array",
          "description": "Multiple document patterns",
          "items": {
            "type": "string"
          }
        }
      ]
    },
    "ExtractConfig": {
      "type": "object",
      "description": "Configuration for extracting GraphQL from TypeScript/JavaScript",
      "properties": {
        "magicComment": {
          "type": "string",
          "description": "Magic comment to look for (e.g., /* GraphQL */)",
          "default": "GraphQL"
        },
        "tagIdentifiers": {
          "type": "array",
          "description": "Tag identifiers to extract (e.g., gql, graphql)",
          "items": {
            "type": "string"
          },
          "default": ["gql", "graphql"]
        },
        "modules": {
          "type": "array",
          "description": "Module names to recognize as GraphQL sources",
          "items": {
            "type": "string"
          },
          "default": [
            "graphql-tag",
            "@apollo/client",
            "apollo-server",
            "apollo-server-express",
            "gatsby",
            "react-relay"
          ]
        },
        "allowGlobalIdentifiers": {
          "type": "boolean",
          "description": "Allow extraction without imports (global identifiers)",
          "default": false
        }
      }
    },
    "LintConfig": {
      "description": "Linting configuration for GraphQL documents",
      "oneOf": [
        {
          "type": "string",
          "enum": ["recommended"],
          "description": "Use a preset: lint: recommended"
        },
        {
          "type": "array",
          "description": "Use multiple presets: lint: [recommended]",
          "items": {
            "type": "string",
            "enum": ["recommended"]
          }
        },
        {
          "$ref": "#/definitions/FullLintConfig",
          "description": "Full configuration with extends and rules"
        }
      ]
    },
    "FullLintConfig": {
      "type": "object",
      "description": "Full lint configuration with optional extends and rules",
      "properties": {
        "extends": {
          "$ref": "#/definitions/ExtendsConfig",
          "description": "Preset(s) to extend"
        },
        "rules": {
          "type": "object",
          "description": "Rule configurations (camelCase names)",
          "properties": {
            "noDeprecated": {
              "$ref": "#/definitions/LintRuleConfig",
              "description": "Warn about usage of deprecated fields and enum values"
            },
            "noAnonymousOperations": {
              "$ref": "#/definitions/LintRuleConfig",
              "description": "Require all operations to have names"
            },
            "uniqueNames": {
              "$ref": "#/definitions/LintRuleConfig",
              "description": "Ensure operation and fragment names are unique across the project"
            },
            "requireIdField": {
              "$ref": "#/definitions/LintRuleConfig",
              "description": "Require selection of ID fields on object types"
            },
            "unusedFragments": {
              "$ref": "#/definitions/LintRuleConfig",
              "description": "Warn about fragments that are defined but never used"
            },
            "unusedFields": {
              "$ref": "#/definitions/LintRuleConfig",
              "description": "Warn about fields that are selected but unused"
            },
            "redundantFields": {
              "$ref": "#/definitions/LintRuleConfig",
              "description": "Warn about redundant field selections"
            },
            "unusedVariables": {
              "$ref": "#/definitions/LintRuleConfig",
              "description": "Warn about variables that are declared but never used"
            },
            "operationNameSuffix": {
              "$ref": "#/definitions/LintRuleConfig",
              "description": "Require operation names to have a specific suffix (Query, Mutation, Subscription)"
            }
          },
          "additionalProperties": {
            "$ref": "#/definitions/LintRuleConfig"
          }
        }
      },
      "additionalProperties": false
    },
    "ExtendsConfig": {
      "description": "Preset(s) to extend",
      "oneOf": [
        {
          "type": "string",
          "enum": ["recommended"],
          "description": "Single preset: extends: recommended"
        },
        {
          "type": "array",
          "description": "Multiple presets: extends: [recommended]",
          "items": {
            "type": "string",
            "enum": ["recommended"]
          }
        }
      ]
    },
    "LintRuleConfig": {
      "description": "Configuration for a single lint rule",
      "oneOf": [
        {
          "$ref": "#/definitions/LintSeverity",
          "description": "Simple severity: warn"
        },
        {
          "type": "array",
          "description": "ESLint-style array: [warn, { options }]",
          "minItems": 1,
          "maxItems": 2,
          "items": [
            {
              "$ref": "#/definitions/LintSeverity"
            },
            {
              "type": "object",
              "description": "Rule-specific options"
            }
          ]
        },
        {
          "type": "object",
          "description": "Object style: { severity: warn, options: {...} }",
          "required": ["severity"],
          "properties": {
            "severity": {
              "$ref": "#/definitions/LintSeverity"
            },
            "options": {
              "type": "object",
              "description": "Rule-specific options"
            }
          }
        }
      ]
    },
    "LintSeverity": {
      "type": "string",
      "enum": ["off", "warn", "error"],
      "description": "Severity level for a lint rule"
    }
  }
}
