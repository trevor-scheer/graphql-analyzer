# Changesets

This directory contains changeset files that document changes for the changelog.

## Quick Start

```bash
# After making changes, create a changeset
knope document-change

# Then edit the generated file to add a PR link (see format below)
```

That's it! When your PR is merged to main, CI will automatically:

1. Detect the changeset
2. Create a Release PR with version bumps and changelogs
3. When the Release PR is merged, build artifacts and create GitHub releases

## Packages

This project has 4 independently versioned packages:

| Package                   | Description             | Changelog                     |
| ------------------------- | ----------------------- | ----------------------------- |
| `graphql-analyzer-cli`    | GraphQL CLI tool        | `crates/cli/CHANGELOG.md`     |
| `graphql-analyzer-lsp`    | GraphQL Language Server | `crates/lsp/CHANGELOG.md`     |
| `graphql-analyzer-mcp`    | GraphQL MCP Server      | `crates/mcp/CHANGELOG.md`     |
| `graphql-analyzer-vscode` | VSCode Extension        | `editors/vscode/CHANGELOG.md` |

## Changeset Format

Create a file in `.changeset/` with any name ending in `.md`:

```markdown
---
graphql-analyzer-cli: patch
graphql-analyzer-lsp: minor
---

Add new feature to CLI and LSP ([#123](https://github.com/trevor-scheer/graphql-analyzer/pull/123))
```

List the packages affected and their bump type. Only include packages that have changes.

**Important:** Always include a link to the PR that implements the change at the end of the first line. This helps users trace changelog entries back to the implementation details.

**Workflow tip:** Since you won't have a PR number when creating the changeset, either:
1. Create the PR first, note the number, then add the changeset with the link
2. Create the changeset, push, create the PR, then amend your commit to add the PR link

### Version Bump Types

- **major**: Breaking changes (API changes, removed features)
- **minor**: New features, significant improvements
- **patch**: Bug fixes, documentation updates

### Examples

**CLI-only change:**

```markdown
---
graphql-analyzer-cli: patch
---

Fix argument parsing bug ([#456](https://github.com/trevor-scheer/graphql-analyzer/pull/456))
```

**Change affecting multiple packages:**

```markdown
---
graphql-analyzer-cli: minor
graphql-analyzer-lsp: minor
graphql-analyzer-mcp: minor
---

Add support for new GraphQL directive ([#789](https://github.com/trevor-scheer/graphql-analyzer/pull/789))
```

**VSCode extension update:**

```markdown
---
graphql-analyzer-vscode: patch
---

Fix syntax highlighting for fragments ([#234](https://github.com/trevor-scheer/graphql-analyzer/pull/234))
```

## When to Create a Changeset

**DO create changesets for:**

- New features
- Bug fixes
- Breaking changes
- Significant improvements

**DON'T create changesets for:**

- Internal refactoring (no behavior change)
- CI/CD changes
- Test-only changes
- Documentation-only changes

## Release Flow

1. Create changesets with `knope document-change`
2. Push/merge to main
3. CI detects changesets → creates Release PR
4. Review and merge Release PR
5. CI builds artifacts → creates GitHub releases for affected packages
